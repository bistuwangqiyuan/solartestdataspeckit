# 产品需求文档：光伏关断器实验数据管理系统

**文档版本**: v1.0  
**创建日期**: 2025-09-13  
**状态**: 正式版  
**产品代号**: PV-SDM (Photovoltaic Shutdown Device Manager)

## 1. 执行摘要

### 1.1 产品愿景
打造一个专业、高效、智能的光伏关断器实验数据管理平台，为光伏产业的质量控制和安全标准提供数字化解决方案。通过现代化的数据管理和可视化技术，提升测试效率，确保产品质量，推动光伏产业的安全发展。

### 1.2 核心价值主张
- **数据标准化**：统一实验数据格式，建立行业标准数据模型
- **智能分析**：自动化数据分析，快速识别质量问题和趋势
- **实时监控**：大屏数据展示，实时掌握测试进度和结果
- **合规追溯**：完整的数据链路，满足行业认证和审计要求

### 1.3 目标用户
- **主要用户**：光伏关断器制造商的质检部门
- **次要用户**：研发工程师、生产管理人员、质量认证机构

## 2. 产品概述

### 2.1 产品定位
PV-SDM是一个基于Web的企业级实验数据管理系统，专门针对光伏关断器的测试数据进行采集、存储、分析和可视化展示。系统采用现代化的技术架构，提供直观的用户界面和强大的数据处理能力。

### 2.2 核心功能模块
1. **数据采集管理**
   - Excel数据批量导入
   - 手动数据录入
   - 数据校验和清洗

2. **测试项目管理**
   - 标准测试项配置
   - 测试流程管理
   - 测试报告生成

3. **数据分析引擎**
   - 统计分析
   - 趋势分析
   - 异常检测

4. **可视化大屏**
   - 实时数据监控
   - 关键指标展示
   - 趋势图表

5. **质量控制**
   - 合格率统计
   - 缺陷分析
   - 质量报表

## 3. 用户场景与需求

### 3.1 主要用户故事

#### 用户故事 1：质检工程师的日常测试
**作为**质检工程师  
**我想要**快速导入和管理测试数据  
**以便**提高工作效率并减少数据错误

**验收标准**：
- 支持拖拽上传Excel文件
- 自动识别数据格式和列名
- 数据导入后立即显示在系统中
- 提供数据预览和确认功能

#### 用户故事 2：管理层的实时监控
**作为**质量部门经理  
**我想要**通过大屏实时查看测试进度和结果  
**以便**及时发现问题并做出决策

**验收标准**：
- 大屏显示今日测试数量、合格率等关键指标
- 实时更新数据，延迟不超过30秒
- 支持多种图表展示（饼图、柱状图、趋势图）
- 可自定义展示指标

#### 用户故事 3：数据分析师的深度分析
**作为**数据分析师  
**我想要**对历史数据进行深度分析  
**以便**发现质量趋势和改进机会

**验收标准**：
- 提供多维度数据筛选功能
- 支持自定义时间范围查询
- 可导出分析报告
- 提供数据对比功能

### 3.2 边界条件处理
- Excel文件大小限制：单文件不超过50MB
- 批量导入限制：单次不超过10,000条记录
- 数据保留期限：默认保存5年历史数据
- 并发用户数：支持100个并发用户

## 4. 功能需求详述

### 4.1 数据管理模块

#### FR-001: Excel数据导入
系统必须支持Excel文件（.xlsx, .xls）的批量导入，自动解析以下数据字段：
- 测试日期时间
- 设备序列号
- 产品型号
- 测试项目名称
- 测试参数值
- 测试结果（合格/不合格）
- 测试人员
- 备注信息

#### FR-002: 数据验证规则
系统必须在数据导入时执行以下验证：
- 必填字段完整性检查
- 数据类型匹配验证
- 数值范围合理性检查
- 重复数据检测

#### FR-003: 数据编辑权限
系统必须提供分级的数据编辑权限：
- 普通用户：仅可查看
- 测试人员：可新增和编辑自己的数据
- 管理员：可编辑所有数据

### 4.2 测试项目配置

#### FR-004: 标准测试项库
系统必须预置光伏关断器的标准测试项目：
- 耐压测试（AC/DC）
- 绝缘电阻测试
- 温升测试
- 机械强度测试
- 防护等级测试
- 电气性能测试

#### FR-005: 自定义测试项
系统必须允许管理员添加自定义测试项目，包括：
- 测试项目名称
- 测试标准依据
- 合格判定标准
- 测试参数模板

### 4.3 数据分析功能

#### FR-006: 统计分析
系统必须提供以下统计功能：
- 总体合格率统计
- 按产品型号分类统计
- 按测试项目分类统计
- 按时间段趋势分析

#### FR-007: 异常检测
系统必须自动识别以下异常情况：
- 连续不合格预警
- 参数超标预警
- 数据异常波动

### 4.4 可视化大屏

#### FR-008: 实时数据展示
大屏必须实时展示以下信息：
- 今日测试总数
- 实时合格率
- 各测试项目进度
- 异常告警信息

#### FR-009: 数据可视化组件
系统必须提供以下可视化组件：
- 仪表盘（合格率、完成率）
- 柱状图（分类统计）
- 折线图（趋势分析）
- 饼图（占比分析）
- 热力图（异常分布）

### 4.5 报表与导出

#### FR-010: 标准报表生成
系统必须支持生成以下标准报表：
- 日报表
- 周报表
- 月度质量报告
- 年度统计报告

#### FR-011: 数据导出功能
系统必须支持以下格式的数据导出：
- Excel格式（保持原始格式）
- PDF格式（适合打印）
- CSV格式（适合数据交换）

## 5. 非功能性需求

### 5.1 性能要求
- **响应时间**：页面加载时间 < 3秒
- **数据处理**：1000条数据导入处理时间 < 10秒
- **并发能力**：支持100个并发用户
- **可用性**：系统可用性 > 99.5%

### 5.2 安全要求
- **数据加密**：传输层使用HTTPS加密
- **访问控制**：基于角色的权限管理
- **审计日志**：记录所有数据操作
- **数据备份**：每日自动备份

### 5.3 用户体验要求
- **响应式设计**：适配桌面端和平板端
- **直观操作**：拖拽式文件上传
- **实时反馈**：操作结果即时提示
- **快捷键支持**：常用功能快捷键

## 6. 技术架构

### 6.1 技术栈
- **前端框架**：Next.js 14+
- **UI组件库**：Shadcn/ui + Tailwind CSS
- **数据可视化**：Chart.js / D3.js
- **后端服务**：Supabase（PostgreSQL + 实时订阅）
- **部署平台**：Netlify
- **状态管理**：Zustand
- **表格组件**：TanStack Table

### 6.2 系统架构
```
┌─────────────────────────────────────────────────────────┐
│                    用户界面层 (Next.js)                    │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌──────────┐  │
│  │数据管理  │  │测试配置  │  │数据分析  │  │ 可视化大屏 │  │
│  └─────────┘  └─────────┘  └─────────┘  └──────────┘  │
└─────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────┐
│                    业务逻辑层 (API Routes)                │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌──────────┐  │
│  │数据处理  │  │权限管理  │  │报表生成  │  │ 实时推送  │  │
│  └─────────┘  └─────────┘  └─────────┘  └──────────┘  │
└─────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────┐
│                   数据服务层 (Supabase)                   │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌──────────┐  │
│  │PostgreSQL│  │Auth服务 │  │Storage  │  │ Realtime │  │
│  └─────────┘  └─────────┘  └─────────┘  └──────────┘  │
└─────────────────────────────────────────────────────────┘
```

## 7. 界面设计规范

### 7.1 设计理念
- **工业美学**：采用深色主题，搭配霓虹蓝光效果
- **数据优先**：突出数据展示，减少装饰性元素
- **清晰层级**：通过颜色、大小、间距建立视觉层级
- **动态交互**：适度使用动画增强用户体验

### 7.2 色彩方案
```
主色调：
- 背景色：#0A0E27 (深邃蓝黑)
- 主色：#00D4FF (电光蓝)
- 辅助色：#7C3AED (深紫)
- 成功色：#10B981 (翡翠绿)
- 警告色：#F59E0B (琥珀黄)
- 错误色：#EF4444 (警示红)

中性色：
- 文字主色：#E5E7EB
- 文字次色：#9CA3AF
- 边框色：#374151
- 卡片背景：#111827
```

### 7.3 字体规范
- **标题字体**：Inter / 思源黑体
- **正文字体**：Inter / 思源黑体
- **数据字体**：JetBrains Mono (等宽字体)

### 7.4 组件设计
- **卡片**：圆角8px，微投影，玻璃态效果
- **按钮**：圆角6px，悬停发光效果
- **图表**：暗色背景，荧光色数据线
- **表格**：斑马纹，悬停高亮

## 8. 数据模型

### 8.1 核心实体

#### Test_Records (测试记录)
```sql
- id: UUID (主键)
- test_date: TIMESTAMP (测试日期时间)
- device_sn: VARCHAR(50) (设备序列号)
- product_model: VARCHAR(50) (产品型号)
- test_item_id: UUID (测试项目ID)
- test_value: JSONB (测试值)
- result: ENUM('PASS', 'FAIL') (测试结果)
- operator_id: UUID (测试人员ID)
- remarks: TEXT (备注)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

#### Test_Items (测试项目)
```sql
- id: UUID (主键)
- name: VARCHAR(100) (测试项目名称)
- category: VARCHAR(50) (测试类别)
- standard_ref: VARCHAR(100) (标准依据)
- pass_criteria: JSONB (合格标准)
- unit: VARCHAR(20) (单位)
- is_active: BOOLEAN
- created_at: TIMESTAMP
```

#### Products (产品信息)
```sql
- id: UUID (主键)
- model: VARCHAR(50) (型号)
- name: VARCHAR(100) (产品名称)
- specifications: JSONB (规格参数)
- manufacturer: VARCHAR(100) (制造商)
- created_at: TIMESTAMP
```

#### Users (用户)
```sql
- id: UUID (主键)
- email: VARCHAR(255) (邮箱)
- name: VARCHAR(100) (姓名)
- role: ENUM('ADMIN', 'OPERATOR', 'VIEWER') (角色)
- department: VARCHAR(50) (部门)
- is_active: BOOLEAN
- created_at: TIMESTAMP
```

### 8.2 数据关系
- Test_Records → Test_Items (多对一)
- Test_Records → Products (多对一)
- Test_Records → Users (多对一)

## 9. 项目里程碑

### Phase 1: 基础功能开发 (第1-2周)
- [ ] 项目初始化和环境配置
- [ ] Supabase数据库设计和配置
- [ ] 基础UI框架搭建
- [ ] 用户认证系统

### Phase 2: 核心功能实现 (第3-4周)
- [ ] Excel数据导入功能
- [ ] 数据管理界面
- [ ] 基础查询和筛选
- [ ] 测试项目配置

### Phase 3: 数据分析与可视化 (第5-6周)
- [ ] 统计分析功能
- [ ] 数据可视化大屏
- [ ] 实时数据更新
- [ ] 趋势分析图表

### Phase 4: 高级功能与优化 (第7-8周)
- [ ] 报表生成和导出
- [ ] 异常检测算法
- [ ] 性能优化
- [ ] 用户体验改进

### Phase 5: 测试与部署 (第9-10周)
- [ ] 全面功能测试
- [ ] 性能测试
- [ ] 安全测试
- [ ] Netlify部署上线

## 10. 成功指标

### 10.1 业务指标
- 数据录入效率提升50%
- 数据错误率降低80%
- 报表生成时间缩短70%
- 用户满意度达到90%

### 10.2 技术指标
- 页面加载时间 < 2秒
- 系统可用性 > 99.5%
- 数据处理准确率 100%
- 并发用户支持 > 100

## 11. 风险评估

### 11.1 技术风险
- **风险**：大量数据导入时的性能问题
- **缓解**：实现分批处理和后台任务队列

### 11.2 业务风险
- **风险**：用户对新系统的接受度
- **缓解**：提供培训和渐进式迁移方案

### 11.3 安全风险
- **风险**：敏感测试数据泄露
- **缓解**：实施严格的权限管理和数据加密

## 12. 附录

### 12.1 术语表
- **光伏关断器**：用于光伏系统紧急情况下快速切断直流电路的安全装置
- **耐压测试**：测试设备在高电压下的绝缘性能
- **绝缘电阻**：衡量电气设备绝缘性能的重要指标

### 12.2 参考标准
- IEC 60947-3: 低压开关设备和控制设备
- UL 1741: 光伏系统用逆变器、转换器和控制器
- GB/T 34936: 光伏发电站安全规程

---

**文档审批**  
产品经理：___________  
技术负责人：___________  
质量负责人：___________  
审批日期：___________